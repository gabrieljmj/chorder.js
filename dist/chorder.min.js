"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var FormTemplate=function(){function a(e,t){_classCallCheck(this,a),this.name=e,this._cloneFromTemplate(t)}return _createClass(a,[{key:"build",value:function(e){var a=this,t=this.template.cloneNode(!0);return t.dataset[this.name]=e,Array.from(t.querySelectorAll("*[cd-field]")).forEach(function(e){var t=e.dataset.cdName;e.setAttribute("name","".concat(a.name,"[").concat(t,"][]"))}),t.querySelector("button[cd-remove]").onclick=function(e){t.outerHTML=""},t}},{key:"_cloneFromTemplate",value:function(e){if(!e.hasAttribute("cd-template"))throw new Error("Invalid template. Add the 'cd-template' parameter.");this.template=e.cloneNode(!0)}}]),a}();function deleteElement(e){e.outerHTML=""}var Chorder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"init",value:function(){var o=this;Array.from(document.querySelectorAll("div[cd]")).forEach(function(e){var t=e.getAttribute("cd"),a=e.querySelector("div[cd-template]"),r=new FormTemplate(t,a),n=e.dataset.initialNumber||1;o.__createInitials(e,r,n),o.__applyEvents(e,r),deleteElement(a)})}},{key:"appendToData",value:function(e,t){e.querySelector("*[cd-data]").append(t.build())}},{key:"getData",value:function(e){var a=[],t=document.querySelector('*[cd="'+e+'"]');return Array.from(t.querySelectorAll("*[data-"+e+"]")).forEach(function(e){var t={};Array.from(e.querySelectorAll("*[cd-field]")).forEach(function(e){t[e.dataset.cdName]=e.value}),a.push(t)}),a}},{key:"__createInitials",value:function(e,t,a){for(var r=1;r<=a;r++)this.appendToData(e,t)}},{key:"__applyEvents",value:function(e,t){var a=this;e.querySelector("*[cd-add]").onclick=function(){a.appendToData(e,t)}}}]),e}();module.exports=Chorder;
